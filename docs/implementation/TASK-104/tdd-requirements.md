# TASK-104: インラインタグ処理の更新 - 要件定義

## 概要

記事内のインラインタグ（`#タグ`）のHTML生成を更新し、TagBadgeコンポーネントと同じCSS変数とクラスを使用して統一されたスタイルで表示する。

## 詳細要件

### 機能要件

1. **スタイル統一** (REQ-004)
   - インラインタグがTagBadgeと同じスタイルで表示される
   - `inline-tag` クラスがTagBadgeの `tag` クラスと同じCSS変数を使用
   - 階層タグと単一タグの区別なく統一されたスタイル

2. **HTML生成の更新**
   - 現在の `<a class="inline-tag">` を維持
   - CSS変数ベースのスタイル適用
   - TagBadgeと視覚的に同一の表示

3. **セキュリティ要件** (NFR-101)
   - XSS対策のHTMLエスケープ処理を維持
   - 特殊文字の適切な処理
   - セキュアなHTML生成

### 技術要件

1. **CSS統合**
   - `inline-tag.css` の活用
   - TagBadgeと同じCSS変数使用
   - レスポンシブ対応

2. **HTML構造の統一**
   ```html
   <a href="/tags/tag-name" class="inline-tag" aria-label="タグラベル" role="link">
     #タグ名
   </a>
   ```

3. **エスケープ処理の維持**
   - 現在の `escapeHtml` 関数を維持
   - セキュリティレベルを下げない

### パフォーマンス要件

1. **処理速度**
   - 正規表現処理の最適化
   - 大量のタグを含む記事でも高速処理

2. **メモリ使用量**
   - Set使用による重複排除の維持
   - 効率的な文字列処理

## 受け入れ基準

### 必須条件

- [ ] インラインタグがTagBadgeと同じスタイルで表示される
- [ ] `inline-tag` クラスが適切なCSS変数を使用している
- [ ] セキュリティ処理（HTMLエスケープ）が維持されている
- [ ] 既存のインラインタグ機能が正常に動作する
- [ ] ダークモードでも適切にスタイルが適用される

### パフォーマンス基準

- [ ] 100個のインラインタグを含む記事が100ms以内にレンダリング
- [ ] 正規表現処理がパフォーマンス要件を満たす
- [ ] メモリリークがない

### セキュリティ基準

- [ ] XSS攻撃が防がれる
- [ ] 特殊文字が適切にエスケープされる
- [ ] 悪意のあるタグ名が無害化される

## テスト対象

1. **機能テスト**
   - インラインタグの抽出と変換
   - HTMLリンク生成
   - エスケープ処理

2. **スタイルテスト**
   - TagBadgeとの視覚的統一
   - CSS変数の適用確認
   - ダークモード表示

3. **セキュリティテスト**
   - XSS対策の確認
   - 特殊文字処理
   - エスケープ処理の検証

## 影響範囲

### 変更対象ファイル
- `src/utils/tag/inline-tags.ts` - メインの変更対象

### 影響を受ける可能性があるファイル
- 記事内でインラインタグを使用している全てのMarkdownファイル
- インラインタグを処理するremarkプラグイン

### 新規作成ファイル
- `test/inline-tags-test.js` - 単体テスト
- `docs/implementation/TASK-104/` - TDDドキュメント

## 実装アプローチ

1. **現在の実装分析**
   - `processInlineTags` 関数の動作確認
   - 生成されるHTMLの構造確認

2. **CSS統合**
   - `inline-tag.css` の既定義を活用
   - TagBadgeとの一貫性確保

3. **テスト戦略**
   - 実際のMarkdownファイルでのテスト
   - ブラウザでの表示確認
   - セキュリティテストの実行