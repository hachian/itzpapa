# TASK-205: 記事内タグ表示統合 - 要件定義

## 📋 概要

記事ページにタグ表示機能を統合し、フロントマターのタグと本文中のインラインタグ（#タグ）を適切に表示する。

## 🎯 主要要件

### REQ-203: 記事ページタグ表示

記事ページにタグ情報を表示し、読者がタグを通じて関連記事にアクセスできるようにする。

**具体的要件:**
- 記事末尾にフロントマターのタグリストを表示
- タグはクリック可能でタグ詳細ページにリンク
- タグの使用回数も表示
- モバイル対応のレスポンシブデザイン

### REQ-104: インラインタグレンダリング

本文中のObsidian形式のタグ（#タグ、#親/子）を自動的にリンク化して表示する。

**具体的要件:**
- 本文中の #タグ を自動検出
- 階層タグ (#親/子/孫) に対応
- 日本語タグ (#日本語タグ) に対応
- タグをクリック可能なリンクとして表示
- 本文の自然な流れを保持

## 🔧 技術要件

### 1. ブログ記事レイアウトの拡張

**ファイル**: `src/layouts/BlogPost.astro`

- 記事末尾にタグセクションを追加
- TagListコンポーネントを統合
- アクセシビリティ対応

### 2. インラインタグレンダリング

**ファイル**: remarkプラグイン拡張

- 既存のremark-tagsプラグインを拡張
- HTMLレンダリング時にタグをリンク化
- TagBadgeコンポーネントのスタイルと整合性保持

### 3. レスポンシブデザイン

- モバイル（< 640px）での適切な表示
- タブレット（640px - 1024px）での最適化
- デスクトップ（> 1024px）での快適な体験

## 💼 ユースケース

### UC-1: 記事読了後のタグ確認

**アクター**: 記事読者

**フロー**:
1. 読者が記事を読み終える
2. 記事末尾のタグセクションを確認
3. 興味のあるタグをクリック
4. タグ詳細ページで関連記事を発見

**期待結果**: 関連記事への自然な導線

### UC-2: 本文中のタグ発見

**アクター**: 記事読者

**フロー**:
1. 読者が記事本文を読んでいる
2. 本文中の #タグ に気づく
3. タグをクリック
4. タグ詳細ページで関連記事を発見

**期待結果**: 読書中断を最小限に抑えた関連記事発見

## 🎨 UI/UX要件

### 記事末尾タグリスト

```
記事タイトル
記事本文...

---

📋 この記事のタグ

#programming (5) #javascript (3) #astro (2)
```

**要件**:
- 視覚的に記事本文と分離
- タグの重要度による視覚的な差別化
- ホバー効果とフォーカス状態

### インラインタグ

```
この記事では #javascript と #react を使って...
```

**要件**:
- 本文の流れを阻害しない控えめなスタイル
- 明確にクリック可能であることを表示
- 階層タグの表示形式統一

## 📱 レスポンシブ要件

### モバイル (< 640px)
- タグを縦方向に配置
- タップしやすいサイズ (44px以上)
- 横スクロール回避

### タブレット (640px - 1024px)  
- 2-3列のグリッドレイアウト
- 適度な間隔とパディング

### デスクトップ (> 1024px)
- 横並びレイアウト
- ホバー効果の活用

## 🌍 アクセシビリティ要件

- **セマンティック HTML**: 適切なHTML要素の使用
- **ARIA ラベル**: スクリーンリーダー対応
- **キーボードナビゲーション**: Tabキーでの移動
- **色彩コントラスト**: WCAG AA準拠
- **フォーカス表示**: 明確なフォーカス状態

## ⚡ パフォーマンス要件

- **レンダリング**: 追加のJavaScript実行時間 < 50ms
- **バンドルサイズ**: 追加サイズ < 5KB
- **SEO**: タグリンクの適切なクローラビリティ

## 🔗 統合要件

### 既存コンポーネントとの連携

- **TagBadge**: 一貫性のあるタグ表示
- **TagList**: 複数タグの整理された表示  
- **レイアウトシステム**: BlogPostレイアウトとの自然な統合

### データフロー

```
記事データ (frontmatter.tags)
    ↓
TagService (タグ処理・統計)
    ↓  
TagList コンポーネント (記事末尾表示)

記事本文 (Markdown)
    ↓
remark-tags プラグイン (インラインタグ検出)
    ↓
HTML出力 (リンク化されたタグ)
```

## ✅ 受け入れ基準

### 機能要件
- [ ] フロントマターのタグが記事末尾に表示される
- [ ] 本文中の #タグ がリンクとして表示される
- [ ] 階層タグ (#親/子) が正しく処理される
- [ ] 日本語タグが正しく表示される
- [ ] 全てのタグリンクが正しいページに遷移する

### 非機能要件
- [ ] モバイルで適切に表示される
- [ ] キーボードナビゲーションが機能する
- [ ] ページロード時間が増加しない
- [ ] SEOフレンドリーなHTML構造

### ユーザビリティ要件
- [ ] タグがクリック可能であることが明確
- [ ] 記事本文の可読性が維持される
- [ ] タグセクションが記事から適切に分離されている
- [ ] 一貫性のあるタグ表示スタイル

## 🧪 テスト戦略

### 単体テスト
- インラインタグ抽出ロジック
- タグリンク生成ロジック
- レスポンシブCSS

### 統合テスト  
- 記事ページでのタグ表示
- タグリンククリック動作
- 階層タグの表示確認

### E2Eテスト
- 記事読了からタグクリックまでのフロー
- モバイルでのタグ操作
- アクセシビリティチェック