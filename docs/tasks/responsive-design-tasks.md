# レスポンシブデザイン 実装タスク

## 概要

全タスク数: 12
推定作業時間: 16-20時間
クリティカルパス: TASK-001 → TASK-101 → TASK-102 → TASK-201

## タスク一覧

### フェーズ1: 基盤構築（ブレークポイント統一）

#### TASK-001: CSS変数統一とブレークポイント定義

- [x] **タスク完了**
- **タスクタイプ**: DIRECT
- **要件リンク**: REQ-1, REQ-4
- **依存タスク**: なし
- **実装詳細**:
  - tag-variables.cssの既存ブレークポイント参照値更新
  - 統一ブレークポイント（767px, 1023px）の定義
  - CSS変数でのレスポンシブ値追加
- **完了条件**:
  - [ ] tag-variables.css:163-165行の参照値が新ブレークポイントに更新
  - [ ] レスポンシブ用CSS変数が定義されている
- **影響範囲**: 低（参照値のみの変更）

### フェーズ2: レイアウト競合解決（段階的移行）

#### TASK-101: global.css 横スクロール防止対応

- [x] **タスク完了**
- **タスクタイプ**: TDD
- **要件リンク**: REQ-1, REQ-2, REQ-3
- **依存タスク**: TASK-001
- **実装詳細**:
  - main要素の固定width: 720pxを段階的にmax-widthに移行
  - フェーズ1: 後方互換性を保ちながら統一ブレークポイント追加
  - フェーズ2: 優先度調整による競合回避
- **テスト要件**:
  - [ ] 単体テスト: 320px〜1920pxで横スクロール発生なし
  - [ ] 統合テスト: 既存レイアウト破綻なし
- **エラーハンドリング**:
  - [ ] 極小画面（320px未満）での対応
  - [ ] 極大画面（1920px以上）での対応
- **影響範囲**: 高（全ページのメインレイアウト）

#### TASK-102: table-of-contents.css グリッドオーバーフロー解決

- [x] **タスク完了**
- **タスクタイプ**: TDD
- **要件リンク**: REQ-3, REQ-7
- **依存タスク**: TASK-101
- **実装詳細**:
  - grid-template-columns: 1fr 250px → 1fr minmax(200px, 300px)に変更
  - min-width: 0をグリッドアイテムに追加
  - 既存768px基準の目次機能を維持
- **テスト要件**:
  - [ ] 単体テスト: グリッドオーバーフローなし
  - [ ] 統合テスト: 目次機能の正常動作
  - [ ] レスポンシブテスト: 768px境界での切り替え確認
- **エラーハンドリング**:
  - [ ] サイドバー幅不足時の対応
  - [ ] 長いタイトルの折り返し処理
- **影響範囲**: 中（目次機能使用ページ）

#### TASK-103: BlogPost.astro レイアウト競合解決

- [x] **タスク完了**
- **タスクタイプ**: TDD
- **要件リンク**: REQ-2, REQ-8
- **依存タスク**: TASK-102
- **実装詳細**:
  - BlogPost.astro:26-30行のwidth指定を調整
  - .prose要素（41行）の720px固定幅をmax-widthに変更
  - global.cssとの優先度競合を解決
- **テスト要件**:
  - [ ] 単体テスト: ブログ記事ページのレスポンシブ表示
  - [ ] 統合テスト: 目次ありなし両パターンでの表示確認
- **エラーハンドリング**:
  - [ ] 目次ありなし切り替え時のレイアウト保持
  - [ ] 長いタイトル・コンテンツの適切な折り返し
- **影響範囲**: 中（ブログ記事ページ）

#### TASK-104: inline-tag.css レスポンシブ統合

- [x] **タスク完了**
- **タスクタイプ**: DIRECT
- **要件リンク**: REQ-4, REQ-8
- **依存タスク**: TASK-001
- **実装詳細**:
  - 640pxブレークポイントを統一BP（767px以下）に変更
  - タグ表示のレスポンシブ調整
- **完了条件**:
  - [ ] 既存640px基準のタグ機能が新ブレークポイントで動作
  - [ ] タッチターゲットサイズ44px以上を確保
- **影響範囲**: 低（タグ表示の微調整）

#### TASK-105: mark.css レスポンシブ統合

- [x] **タスク完了**
- **タスクタイプ**: DIRECT
- **要件リンク**: REQ-4, REQ-9
- **依存タスク**: TASK-001
- **実装詳細**:
  - 720pxブレークポイントを統一BP（767px以下）に変更
  - マークハイライト機能のレスポンシブ調整
- **完了条件**:
  - [ ] 既存720px基準のマーク機能が新ブレークポイントで動作
  - [ ] ウィキリンク機能との互換性維持
- **影響範囲**: 低（マーク表示の微調整）

### フェーズ3: 画像・メディア最適化

#### TASK-201: 画像レスポンシブ対応

- [x] **タスク完了**
- **タスクタイプ**: TDD
- **要件リンク**: REQ-6
- **依存タスク**: TASK-103
- **実装詳細**:
  - 全画像要素にmax-width: 100%適用
  - BlogPost.astroのhero-image（84-86行）調整
  - aspect-ratio対応（オプション）
- **UI/UX要件**:
  - [ ] ローディング状態: 画像読み込み中のスケルトン表示
  - [ ] エラー表示: 画像読み込み失敗時の代替表示
  - [ ] モバイル対応: 画像のタッチズーム対応
  - [ ] アクセシビリティ: alt属性の適切な設定
- **テスト要件**:
  - [ ] 単体テスト: 各画面サイズでの画像表示確認
  - [ ] パフォーマンステスト: 画像読み込み時間3秒以内
- **完了条件**:
  - [ ] 全画像が画面幅に収まる
  - [ ] アスペクト比が維持されている
- **影響範囲**: 中（全画像要素）

### フェーズ4: 品質保証・テスト実装

#### TASK-301: Playwright基本設定

- [x] **タスク完了**
- **タスクタイプ**: DIRECT
- **要件リンク**: 全要件
- **依存タスク**: TASK-201
- **実装詳細**:
  - Playwrightの初期設定
  - テスト用ビューポートサイズ定義（320px, 767px, 1023px, 1200px）
  - CI/CD統合設定
- **完了条件**:
  - [ ] Playwrightが正常に動作する
  - [ ] 基本テストスイートが実行可能
- **影響範囲**: なし（テスト環境のみ）

#### TASK-302: 横スクロール自動検知テスト

- [x] **タスク完了**
- **タスクタイプ**: TDD
- **要件リンク**: REQ-1, REQ-2, REQ-3
- **依存タスク**: TASK-301
- **実装詳細**:
  - scrollWidth vs clientWidth による横スクロール検知
  - 全ページでの自動テスト
  - 各ビューポートサイズでの検証
- **テスト要件**:
  - [ ] 主要ページ（トップ、ブログ記事、タグページ）での検証
  - [ ] 4つのビューポートサイズでの全自動テスト
- **完了条件**:
  - [ ] 320px〜1920pxで横スクロールが検出されない
  - [ ] テスト失敗時に具体的な問題箇所が特定可能
- **影響範囲**: なし（テストのみ）

#### TASK-303: レスポンシブレイアウト切り替えテスト

- [x] **タスク完了**
- **タスクタイプ**: TDD
- **要件リンク**: REQ-4, REQ-7, REQ-8
- **依存タスク**: TASK-302
- **実装詳細**:
  - ブレークポイント（767px, 1023px）での表示切り替え確認
  - 目次機能のグリッド→フレックス切り替え
  - タグ機能のレスポンシブ動作確認
- **テスト要件**:
  - [ ] レイアウト切り替え境界値でのテスト
  - [ ] 目次機能の768px基準維持確認
  - [ ] タグ機能の640px基準から新BP移行確認
- **完了条件**:
  - [ ] 各ブレークポイントで期待されるレイアウト表示
  - [ ] 既存機能の互換性維持
- **影響範囲**: なし（テストのみ）

#### TASK-304: ビジュアル回帰テスト

- [x] **タスク完了**
- **タスクタイプ**: TDD
- **要件リンク**: 全要件
- **依存タスク**: TASK-303
- **実装詳細**:
  - 主要ページのスクリーンショット比較
  - 実装前後のビジュアル差分検出
  - 各ブレークポイントでのスナップショット
- **テスト要件**:
  - [ ] 主要ページでの4サイズスクリーンショット
  - [ ] 実装前ベースラインとの差分分析
  - [ ] 許容範囲を超えた変更の検出
- **完了条件**:
  - [ ] 意図しないビジュアル変更がない
  - [ ] レスポンシブ対応が適切に表示される
- **影響範囲**: なし（テストのみ）

### フェーズ5: 最終検証・ドキュメント

#### TASK-401: パフォーマンス・アクセシビリティ検証

- [x] **タスク完了**
- **タスクタイプ**: TDD
- **要件リンク**: NFR-001, NFR-002, NFR-003, NFR-201, NFR-202, NFR-203
- **依存タスク**: TASK-304
- **実装詳細**:
  - Core Web Vitals測定
  - アクセシビリティ（WCAG 2.1 AA）準拠確認
  - 初回ページ読み込み時間の劣化チェック
- **テスト要件**:
  - [ ] LCP, CLS, FID測定
  - [ ] スクリーンリーダーテスト
  - [ ] キーボードナビゲーションテスト
  - [ ] カラーコントラスト測定
- **完了条件**:
  - [ ] 全NFR要件をクリア
  - [ ] 既存パフォーマンスから20%以上劣化していない
- **影響範囲**: なし（検証のみ）

#### TASK-402: 実装ガイド作成

- [x] **タスク完了**
- **タスクタイプ**: DIRECT
- **要件リンク**: 完了定義
- **依存タスク**: TASK-401
- **実装詳細**:
  - 実装変更点の詳細ドキュメント
  - 今後のメンテナンス指針
  - トラブルシューティングガイド
- **完了条件**:
  - [ ] 実装ガイド文書が作成されている
  - [ ] コードレビュー用チェックリストが含まれている
- **影響範囲**: なし（ドキュメントのみ）

## 実行順序とマイルストーン

### マイルストーン1: 基盤完了（推定：2-3時間）
- TASK-001完了
- 新ブレークポイント定義済み

### マイルストーン2: レイアウト競合解決（推定：8-10時間）
- TASK-101, 102, 103完了
- 横スクロール問題解決済み
- 既存機能互換性確保済み

### マイルストーン3: 統合完了（推定：4-5時間）
- TASK-104, 105, 201完了
- 全要素のレスポンシブ対応完了

### マイルストーン4: 品質保証完了（推定：4-5時間）
- TASK-301〜304完了
- 自動テストスイート完成

### マイルストーン5: プロダクション準備完了（推定：2-3時間）
- TASK-401, 402完了
- デプロイメント準備完了

## 並行実行可能なタスク

- **グループA（基盤後）**: TASK-104, TASK-105（同時実行可能）
- **グループB（テスト）**: TASK-302, TASK-303（部分的に並行可能）

## クリティカルパス

```
TASK-001 → TASK-101 → TASK-102 → TASK-103 → TASK-201 → TASK-301 → TASK-302 → TASK-303 → TASK-304 → TASK-401 → TASK-402
```

**最重要**: TASK-101（global.css横スクロール防止）- ここが失敗すると全体に影響

## リスク評価

### 高リスク
- **TASK-101**: global.css変更による既存レイアウト破綻
- **TASK-102**: 目次機能のグリッド変更による表示崩れ

### 中リスク
- **TASK-103**: BlogPost.astroでの競合解決
- **TASK-302**: Playwrightテストでの横スクロール検知精度

### 低リスク
- **TASK-104, 105**: 微細なブレークポイント調整
- **TASK-201**: 画像レスポンシブ対応

## サブタスクテンプレート

### TDDタスクの場合

各TDDタスクは以下のプロセスで実装：

1. `tdd-requirements.md` - 詳細要件定義
2. `tdd-testcases.md` - テストケース作成
3. `tdd-red.md` - テスト実装（失敗）
4. `tdd-green.md` - 最小実装
5. `tdd-refactor.md` - リファクタリング
6. `tdd-verify-complete.md` - 品質確認

### DIRECTタスクの場合

各DIRECTタスクは以下のプロセスで実装：

1. `direct-setup.md` - 直接実装・設定
2. `direct-verify.md` - 動作確認・品質確認

---

**作成日**: 2025-09-17
**要件ベース**: responsive-requirements.md v1.0
**推定総工数**: 16-20時間
**タスク総数**: 12タスク（TDD: 7タスク、DIRECT: 5タスク）