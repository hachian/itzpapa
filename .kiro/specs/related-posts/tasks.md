# Implementation Plan

## Tasks

- [x] 1. 関連記事取得ユーティリティ関数の実装
- [x] 1.1 タグベースのスコアリングロジックを実装する
  - 現在の記事のタグと他記事のタグを比較し、共通タグ数をスコアとして計算する
  - スコアが0の記事（共通タグなし）は結果から除外する
  - タグが設定されていない記事は関連記事候補から除外する
  - 現在閲覧中の記事自身を結果から除外する
  - _Requirements: 1.4, 2.1, 2.3, 2.4_

- [x] 1.2 ソートと件数制限のロジックを実装する
  - スコアの高い順（降順）にソートする
  - 同スコアの場合は公開日の新しい順でソートする
  - 最大取得件数（デフォルト5件）で結果を切り詰める
  - _Requirements: 1.1, 2.2_

- [x] 1.3 (P) ユーティリティ関数の単体テストを作成する
  - スコアリングが正しく計算されることを検証する
  - 自記事除外、タグなし除外が動作することを検証する
  - ソート順序（スコア降順、日付降順）が正しいことを検証する
  - 件数制限が適用されることを検証する
  - _Requirements: 1.1, 1.4, 2.1, 2.2, 2.3, 2.4_

- [x] 2. 関連記事カードコンポーネントの実装
- [x] 2.1 (P) カードの基本構造とスタイルを実装する
  - カード全体をリンクとして実装し、クリックで記事ページへ遷移する
  - 記事タイトル、公開日、説明文（存在する場合）を表示する
  - 既存のCSS変数を使用してテーマと一貫性のあるスタイリングを適用する
  - _Requirements: 3.1, 3.5_

- [x] 2.2 画像表示機能を実装する
  - アイキャッチ画像が存在する場合は最適化された画像を表示する
  - 画像が存在しない場合はプレースホルダーを非表示にする
  - _Requirements: 3.2_

- [x] 2.3 ダークモード対応を実装する
  - `html.dark` セレクタを使用してダークモード時のスタイルを適用する
  - 背景色、テキスト色、ボーダー色をダークモードに対応させる
  - _Requirements: 3.3_

- [x] 3. 関連記事セクションコンポーネントの実装
- [x] 3.1 セクションの基本構造を実装する
  - ユーティリティ関数を使用して関連記事を取得する
  - セクションタイトルを国際化対応で表示する
  - 関連記事カードをリスト表示する
  - _Requirements: 1.1, 4.1, 4.2_

- [x] 3.2 条件付き表示ロジックを実装する
  - 関連記事が0件の場合はセクション全体を非表示にする
  - _Requirements: 1.2_

- [x] 3.3 レスポンシブグリッドレイアウトを実装する
  - モバイルでは1列、タブレットでは2列、デスクトップでは3列のグリッドを実装する
  - CSS Gridを使用してレスポンシブに対応する
  - _Requirements: 3.4_

- [x] 4. BlogPostレイアウトへの統合
- [x] 4.1 関連記事セクションをレイアウトに追加する
  - Commentsコンポーネントの直前に関連記事セクションを配置する
  - 現在の記事IDとタグをコンポーネントに渡す
  - _Requirements: 4.1_

- [x] 4.2 機能フラグによる表示制御を実装する
  - `site.config.features.relatedPosts`フラグがfalseの場合は非表示にする
  - タグが設定されていない記事では関連記事セクションを表示しない
  - _Requirements: 1.3_

- [x] 5. 国際化対応
- [x] 5.1 翻訳キーを追加する
  - 関連記事セクションのタイトル用翻訳キーを追加する
  - 日本語と英語の翻訳を設定する
  - _Requirements: 1.1_

- [x] 6. 統合テストと動作確認
- [x] 6.1 ビルドとプレビューで動作確認する
  - ビルドが正常に完了することを確認する
  - 記事ページで関連記事セクションが正しく表示されることを確認する
  - レスポンシブ動作とダークモード切り替えを確認する
  - _Requirements: 1.1, 3.3, 3.4, 4.1, 4.2_
