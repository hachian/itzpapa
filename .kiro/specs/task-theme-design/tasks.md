# Implementation Plan

## Tasks

- [x] 1. remarkプラグインの基盤実装
- [x] 1.1 (P) タスク構文の検出とステータス抽出ロジックを実装する
  - リストアイテム内の`[x]`パターンを正規表現で検出する機能を構築
  - 22種類のステータス文字を認識し、対応するステータス名にマッピング
  - 未定義のステータス文字は`unknown`として処理するフォールバックを含める
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 2.1, 2.2, 3.1, 3.2, 3.3, 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 5.3, 5.4, 6.1, 6.2, 6.3, 6.4, 6.5, 8.1, 8.2_

- [x] 1.2 タスク構文をアクセシビリティ対応のHTML要素に変換する
  - 検出したタスク構文を`<span data-task-status="...">...</span>`形式に変換
  - ステータスごとに適切な`aria-label`属性を付与してスクリーンリーダー対応
  - アイコン要素に`aria-hidden="true"`を設定して装飾的要素であることを明示
  - 1.1で実装した検出ロジックを使用（依存）
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 2.1, 2.2, 3.1, 3.2, 3.3, 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 5.3, 5.4, 6.1, 6.2, 6.3, 6.4, 6.5_

- [x] 2. CSSスタイルの実装
- [x] 2.1 (P) タスクアイコンのCSS変数とカラーパレットを定義する
  - 22種類のステータスに対応するLucide IconsのSVGをdata URI形式で変数化
  - 7つのカラーカテゴリ（neutral, success, warning, danger, info, accent, muted）を定義
  - ダークモード用のカラー調整値を設定
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 2.1, 2.2, 3.1, 3.2, 3.3, 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 5.3, 5.4, 6.1, 6.2, 6.3, 6.4, 6.5_

- [x] 2.2 タスクチェックボックスの基本スタイルを実装する
  - `.task-checkbox`クラスのレイアウトとサイズを定義
  - CSSマスクを使用してアイコンを表示する仕組みを構築
  - 2.1で定義した変数を使用（依存）
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 2.1, 2.2, 3.1, 3.2, 3.3, 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 5.3, 5.4, 6.1, 6.2, 6.3, 6.4, 6.5_

- [x] 2.3 22種類のステータス別スタイルを実装する
  - 各`data-task-status`値に対応するアイコンと色を設定
  - 基本4種（todo, done, incomplete, canceled）のスタイル
  - スケジューリング2種（forwarded, scheduling）のスタイル
  - 重要度3種（question, important, star）のスタイル
  - 参照4種（quote, location, bookmark, information）のスタイル
  - アイデア4種（savings, idea, pros, cons）のスタイル
  - アクション5種（fire, key, win, up, down）のスタイル
  - 2.2の基本スタイルに依存
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 2.1, 2.2, 3.1, 3.2, 3.3, 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 5.3, 5.4, 6.1, 6.2, 6.3, 6.4, 6.5_

- [x] 2.4 表示専用の非インタラクティブスタイルを適用する
  - `pointer-events: none`でクリックイベントを無効化
  - `cursor: default`で非インタラクティブを視覚的に示す
  - チェックボックスのdisabled状態のスタイリング
  - _Requirements: 7.1, 7.2, 7.3_

- [x] 2.5 ダークモード対応のスタイル調整を行う
  - `html.dark`セレクタでダークモード用の色を上書き
  - `prefers-color-scheme: dark`メディアクエリでOS設定に対応
  - 各カラーカテゴリのライトネス値を調整して視認性を確保
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 2.1, 2.2, 3.1, 3.2, 3.3, 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 5.3, 5.4, 6.1, 6.2, 6.3, 6.4, 6.5_

- [x] 3. システム統合
- [x] 3.1 Astro設定にremarkプラグインを登録する
  - `astro.config.mjs`のremarkPlugins配列にプラグインを追加
  - WikiLinkプラグインの直後、MarkHighlightプラグインの前に配置
  - MDX統合とMarkdown設定の両方に同じ設定を適用
  - Task 1（remarkプラグイン）の完成が必要（依存）
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 2.1, 2.2, 3.1, 3.2, 3.3, 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 5.3, 5.4, 6.1, 6.2, 6.3, 6.4, 6.5, 8.1, 8.2_

- [x] 3.2 CSSをグローバルスタイルに統合する
  - `global.css`に`@import './task.css';`を追加
  - インポート順序を適切に配置（design-tokens.cssの後）
  - Task 2（CSS）の完成が必要（依存）
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 2.1, 2.2, 3.1, 3.2, 3.3, 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 5.3, 5.4, 6.1, 6.2, 6.3, 6.4, 6.5, 7.1, 7.2, 7.3_

- [x] 4. テストとビルド検証
- [x] 4.1 remarkプラグインのユニットテストを作成する
  - 22種類のステータス文字それぞれの変換を検証
  - 未定義ステータス文字のフォールバック動作を検証
  - ネストされたリスト内のタスク処理を検証
  - コードブロック内のタスク構文がスキップされることを検証
  - Task 1（remarkプラグイン）の完成が必要（依存）
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 2.1, 2.2, 3.1, 3.2, 3.3, 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 5.3, 5.4, 6.1, 6.2, 6.3, 6.4, 6.5, 8.1, 8.2_

- [x] 4.2 ビルドとプレビューで動作確認を行う
  - `npm run build`でエラーなくビルドが完了することを確認
  - `npm run preview`でタスクアイコンが正しく表示されることを確認
  - ダークモード切り替えで色が適切に変化することを確認
  - Task 3（システム統合）の完成が必要（依存）
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 2.1, 2.2, 3.1, 3.2, 3.3, 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 5.3, 5.4, 6.1, 6.2, 6.3, 6.4, 6.5, 7.1, 7.2, 7.3, 8.1, 8.2_

## Requirements Coverage

| Requirement | Tasks |
|-------------|-------|
| 1.1 (to-do) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 1.2 (done) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 1.3 (incomplete) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 1.4 (canceled) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 2.1 (forwarded) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 2.2 (scheduling) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 3.1 (question) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 3.2 (important) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 3.3 (star) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 4.1 (quote) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 4.2 (location) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 4.3 (bookmark) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 4.4 (information) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 5.1 (savings) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 5.2 (idea) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 5.3 (pros) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 5.4 (cons) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 6.1 (fire) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 6.2 (key) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 6.3 (win) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 6.4 (up) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 6.5 (down) | 1.1, 1.2, 2.1, 2.2, 2.3, 2.5, 3.1, 3.2, 4.1, 4.2 |
| 7.1 (disabled) | 2.4, 3.2, 4.2 |
| 7.2 (no state change) | 2.4, 3.2, 4.2 |
| 7.3 (no pointer) | 2.4, 3.2, 4.2 |
| 8.1 (unknown default) | 1.1, 3.1, 4.1, 4.2 |
| 8.2 (fallback) | 1.1, 3.1, 4.1, 4.2 |
