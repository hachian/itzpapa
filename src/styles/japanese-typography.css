/**
 * Japanese Typography Optimization
 * 日本語特有のタイポグラフィ設定
 *
 * Requirements: 2.1, 2.3, 3.4
 */

/* =========================================
   Japanese Text Optimization
   ========================================= */

/* 文字間隔と約物配置の最適化 */
.prose {
  letter-spacing: 0.03em;  /* 和文の標準的な字間 */
  font-feature-settings: "palt" 1;  /* プロポーショナル約物配置 */
}

/* =========================================
   Heading Styles
   ========================================= */

/* 見出しの折り返しとスタイル設定 */
.prose h1,
.prose h2,
.prose h3,
.prose h4 {
  text-wrap: balance;  /* 自然な日本語の折り返し */
  font-weight: var(--font-weight-semibold);
}

/* 見出しサイズ - 本文サイズに連動 */
.prose h1 {
  font-size: 2em;
}

.prose h2 {
  font-size: 1.75em;
  /* 見出し装飾: 左ボーダー + 背景色 */
  border-left: 4px solid var(--color-accent);
  background-color: var(--color-primary-500-alpha05);
  padding: var(--space-2) var(--space-4);
  border-radius: var(--radius-sm);
  margin-top: var(--space-8);
}

.prose h3 {
  font-size: 1.5em;
  /* 見出し装飾: ストライプ下線 */
  position: relative;
  padding-bottom: var(--space-2);
  margin-top: var(--space-6);
}

.prose h3::after {
  content: '';
  position: absolute;
  left: 0;
  bottom: 0;
  width: 100%;
  height: 7px;
  background: repeating-linear-gradient(
    -45deg,
    var(--color-primary-400),
    var(--color-primary-400) 2px,
    transparent 2px,
    transparent 4px
  );
}

.prose h4 {
  font-size: 1.25em;
  /* 見出し装飾: 実線下線 */
  border-bottom: 2px solid var(--color-primary-400);
  padding-bottom: var(--space-1);
  margin-top: var(--space-5);
}

/* =========================================
   Additional Japanese Typography Utilities
   ========================================= */

/* 禁則処理の最適化 */
.prose {
  overflow-wrap: break-word;
  line-break: strict;  /* 厳格な禁則処理 */
}

/* リストスタイルは list.css に移動 */

/* コードブロック内は等幅フォント用に字間をリセット */
.prose code,
.prose pre {
  letter-spacing: normal;
  font-feature-settings: normal;
}

/* =========================================
   Heading Decoration - Dark Mode
   ========================================= */

/* html.dark セレクタ */
html.dark .prose h2 {
  background-color: var(--color-primary-dark-alpha08);
}

html.dark .prose h3::after {
  background: repeating-linear-gradient(
    -45deg,
    var(--color-primary-300),
    var(--color-primary-300) 2px,
    transparent 2px,
    transparent 4px
  );
}

html.dark .prose h4 {
  border-bottom-color: var(--color-primary-300);
}

/* OS Dark Mode Preference */
@media (prefers-color-scheme: dark) {
  :root:not(.light) .prose h2 {
    background-color: var(--color-primary-dark-alpha08);
  }

  :root:not(.light) .prose h3::after {
    background: repeating-linear-gradient(
      -45deg,
      var(--color-primary-300),
      var(--color-primary-300) 2px,
      transparent 2px,
      transparent 4px
    );
  }

  :root:not(.light) .prose h4 {
    border-bottom-color: var(--color-primary-300);
  }
}

/* =========================================
   Heading Decoration - Responsive
   ========================================= */

/* モバイル対応 (768px未満) */
@media (max-width: 767px) {
  .prose h2 {
    padding: var(--space-1) var(--space-3);
  }

  .prose h3 {
    padding-bottom: var(--space-1);
  }
}
