/**
 * Design Tokens - デザインシステム基盤
 *
 * OKLCHベースの統一カラーシステム、スペーシング、タイポグラフィ、
 * アニメーション、シャドウなどのデザイントークンを定義
 *
 * Requirements: 1.1-1.5, 3.1-3.2, 7.1, 7.3, 8.1-8.2, 8.4
 */

/* =========================================
   OKLCH Fallback for older browsers
   ========================================= */
@supports not (color: oklch(0% 0 0)) {
  :root {
    /* Primary Purple Palette - Hex Fallbacks */
    --color-primary-50: #faf5ff;
    --color-primary-100: #f3e8ff;
    --color-primary-200: #e9d5ff;
    --color-primary-300: #d8b4fe;
    --color-primary-400: #c084fc;
    --color-primary-500: #7c3aed;
    --color-primary-600: #6d28d9;
    --color-primary-700: #5b21b6;
    --color-primary-800: #4c1d95;
    --color-primary-900: #3b0764;

    /* Neutral Gray Palette - Hex Fallbacks */
    --color-gray-50: #faf5ff;
    --color-gray-100: #f3e8ff;
    --color-gray-200: #e9d5ff;
    --color-gray-300: #d8b4fe;
    --color-gray-400: #a78bfa;
    --color-gray-500: #7c3aed;
    --color-gray-600: #6d28d9;
    --color-gray-700: #5b21b6;
    --color-gray-800: #3d2b5c;
    --color-gray-900: #2d2240;

    /* Semantic Colors - Hex Fallbacks */
    --color-background: #fafafa;
    --color-surface: #ffffff;
    --color-text-primary: #18181b;
    --color-text-secondary: #52525b;
    --color-accent: #7c3aed;

    /* Shadows - RGBA Fallbacks */
    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.07), 0 2px 4px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1), 0 4px 6px rgba(0, 0, 0, 0.05);
    --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.1), 0 8px 10px rgba(0, 0, 0, 0.04);
  }
}

/* =========================================
   OKLCH Color System
   ========================================= */
:root {
  /* Primary Hue - This value is set by site.config.ts
   * Default: 293 (Purple)
   * See site.config.ts theme.primaryHue to change the color scheme
   */

  /* Primary Palette (OKLCH)
   * Lightness varies from 97% (50) to 25% (900)
   */
  --color-primary-50: oklch(97% 0.02 var(--primary-hue));
  --color-primary-100: oklch(94% 0.05 var(--primary-hue));
  --color-primary-200: oklch(88% 0.10 var(--primary-hue));
  --color-primary-300: oklch(78% 0.16 var(--primary-hue));
  --color-primary-400: oklch(68% 0.20 var(--primary-hue));
  --color-primary-500: oklch(55% 0.24 var(--primary-hue));
  --color-primary-600: oklch(48% 0.22 var(--primary-hue));
  --color-primary-700: oklch(40% 0.19 var(--primary-hue));
  --color-primary-800: oklch(32% 0.15 var(--primary-hue));
  --color-primary-900: oklch(25% 0.12 var(--primary-hue));

  /* Neutral Gray Palette (OKLCH)
   * Uses primary hue for cohesion with primary color
   * Dark grays (800-900) use higher lightness for eye comfort
   */
  --color-gray-50: oklch(98% 0.005 var(--primary-hue));
  --color-gray-100: oklch(96% 0.008 var(--primary-hue));
  --color-gray-200: oklch(92% 0.010 var(--primary-hue));
  --color-gray-300: oklch(85% 0.012 var(--primary-hue));
  --color-gray-400: oklch(70% 0.015 var(--primary-hue));
  --color-gray-500: oklch(55% 0.015 var(--primary-hue));
  --color-gray-600: oklch(45% 0.015 var(--primary-hue));
  --color-gray-700: oklch(35% 0.015 var(--primary-hue));
  --color-gray-800: oklch(30% 0.012 var(--primary-hue));
  --color-gray-900: oklch(22% 0.010 var(--primary-hue));

  /* Semantic Colors */
  --color-background: var(--color-gray-50);
  --color-surface: oklch(100% 0 0);
  --color-text-primary: var(--color-gray-900);
  --color-text-secondary: var(--color-gray-600);
  --color-accent: var(--color-primary-500);
  --color-link: var(--color-primary-600);
  --color-link-hover: var(--color-primary-700);

  /* Semantic State Colors (Light Mode) */
  --color-success: oklch(65% 0.20 145);
  --color-success-bg: oklch(65% 0.20 145 / 0.1);
  --color-warning: oklch(75% 0.18 75);
  --color-warning-bg: oklch(75% 0.18 75 / 0.1);
  --color-error: oklch(60% 0.25 25);
  --color-error-bg: oklch(60% 0.25 25 / 0.1);
  --color-info: oklch(65% 0.20 260);
  --color-info-bg: oklch(65% 0.20 260 / 0.1);

  /* Component Colors */
  --article-bg: var(--color-surface);
  --article-border: var(--color-gray-200);
  --article-shadow: var(--shadow-md);
  --card-bg: var(--color-surface);
  --card-border: var(--color-gray-200);

  /* Component-specific color utilities */
  --color-primary-hover-dark: oklch(30% 0.08 var(--primary-hue));
  --color-primary-500-alpha05: oklch(55% 0.24 var(--primary-hue) / 0.05);
  --color-primary-500-alpha08: oklch(55% 0.24 var(--primary-hue) / 0.08);
  --color-primary-500-alpha10: oklch(55% 0.24 var(--primary-hue) / 0.1);
  --color-primary-500-alpha12: oklch(55% 0.24 var(--primary-hue) / 0.12);
  --color-primary-500-alpha20: oklch(55% 0.24 var(--primary-hue) / 0.2);
  --color-primary-500-alpha30: oklch(55% 0.24 var(--primary-hue) / 0.3);
  --color-primary-500-alpha40: oklch(55% 0.24 var(--primary-hue) / 0.4);
  --color-primary-500-alpha50: oklch(55% 0.24 var(--primary-hue) / 0.5);
  --color-primary-dark-alpha20: oklch(65% 0.20 var(--primary-hue) / 0.2);
  --color-primary-dark-alpha30: oklch(65% 0.20 var(--primary-hue) / 0.3);
  --color-primary-dark-alpha50: oklch(65% 0.20 var(--primary-hue) / 0.5);
  --color-dark-surface-97: oklch(20% 0.02 var(--primary-hue) / 0.97);
  --color-dark-surface-98: oklch(20% 0.02 var(--primary-hue) / 0.98);

  /* =========================================
     Spacing Scale (4px base)
     ========================================= */
  --space-0: 0;
  --space-1: 0.25rem;   /* 4px */
  --space-2: 0.5rem;    /* 8px */
  --space-3: 0.75rem;   /* 12px */
  --space-4: 1rem;      /* 16px */
  --space-5: 1.25rem;   /* 20px */
  --space-6: 1.5rem;    /* 24px */
  --space-8: 2rem;      /* 32px */
  --space-10: 2.5rem;   /* 40px */
  --space-12: 3rem;     /* 48px */
  --space-16: 4rem;     /* 64px */
  --space-20: 5rem;     /* 80px */
  --space-24: 6rem;     /* 96px */

  /* =========================================
     Typography Scale
     ========================================= */
  --font-size-xs: 0.75rem;    /* 12px */
  --font-size-sm: 0.875rem;   /* 14px */
  --font-size-base: 1rem;     /* 16px */
  --font-size-lg: 1.125rem;   /* 18px */
  --font-size-xl: 1.25rem;    /* 20px */
  --font-size-2xl: 1.5rem;    /* 24px */
  --font-size-3xl: 1.875rem;  /* 30px */
  --font-size-4xl: 2.25rem;   /* 36px */
  --font-size-5xl: 3rem;      /* 48px */

  /* Line Heights */
  --line-height-tight: 1.25;
  --line-height-snug: 1.375;
  --line-height-normal: 1.5;
  --line-height-relaxed: 1.625;
  --line-height-loose: 1.9;   /* Japanese text optimal - 日本語本文用 */

  /* Heading Scale - 見出しサイズ（本文サイズに連動） */
  --heading-scale-h1: 2.5em;
  --heading-scale-h2: 2em;
  --heading-scale-h3: 1.5em;
  --heading-scale-h4: 1.25em;

  /* Font Weights */
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;

  /* Font Families */
  --font-family-sans: "Noto Sans JP", "Hiragino Kaku Gothic Pro", "Meiryo", sans-serif;
  --font-family-display: "Atkinson", var(--font-family-sans);
  --font-family-mono: ui-monospace, "Cascadia Code", "Source Code Pro", Menlo, Consolas, monospace;

  /* =========================================
     Animation Tokens
     ========================================= */
  --duration-instant: 0ms;
  --duration-fast: 150ms;
  --duration-normal: 300ms;
  --duration-slow: 500ms;
  --duration-slower: 700ms;

  --easing-default: cubic-bezier(0.4, 0, 0.2, 1);
  --easing-in: cubic-bezier(0.4, 0, 1, 1);
  --easing-out: cubic-bezier(0, 0, 0.2, 1);
  --easing-in-out: cubic-bezier(0.4, 0, 0.2, 1);
  --easing-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);

  /* =========================================
     Shadows (OKLCH)
     ========================================= */
  --shadow-sm: 0 1px 2px oklch(0% 0 0 / 0.05);
  --shadow-md: 0 4px 6px oklch(0% 0 0 / 0.07), 0 2px 4px oklch(0% 0 0 / 0.06);
  --shadow-lg: 0 10px 15px oklch(0% 0 0 / 0.1), 0 4px 6px oklch(0% 0 0 / 0.05);
  --shadow-xl: 0 20px 25px oklch(0% 0 0 / 0.1), 0 8px 10px oklch(0% 0 0 / 0.04);
  --shadow-2xl: 0 25px 50px oklch(0% 0 0 / 0.25);
  --shadow-inner: inset 0 2px 4px oklch(0% 0 0 / 0.06);

  /* =========================================
     Border Radius
     ========================================= */
  --radius-none: 0;
  --radius-sm: 0.25rem;   /* 4px */
  --radius-md: 0.5rem;    /* 8px */
  --radius-lg: 0.75rem;   /* 12px */
  --radius-xl: 1rem;      /* 16px */
  --radius-2xl: 1.5rem;   /* 24px */
  --radius-full: 9999px;

  /* =========================================
     Focus & Accessibility
     ========================================= */
  --focus-ring-width: 2px;
  --focus-ring-offset: 2px;
  --focus-ring-color: var(--color-primary-500);
  --touch-target-min: 44px;

  /* =========================================
     Breakpoints (Reference values for JS/documentation)
     CSS media queries must use literal values
     ========================================= */
  --breakpoint-sm: 480px;
  --breakpoint-md: 768px;
  --breakpoint-lg: 1024px;
  --breakpoint-xl: 1440px;

  /* =========================================
     Layout
     ========================================= */
  --content-max-width: 720px;
  --content-wide-max-width: 960px;
  --content-padding: var(--space-4);
  --header-height: 64px;

  /* =========================================
     Z-Index Scale
     ========================================= */
  --z-base: 0;
  --z-dropdown: 10;
  --z-sticky: 50;
  --z-fixed: 100;
  --z-modal-backdrop: 200;
  --z-modal: 300;
  --z-tooltip: 400;
}

/* =========================================
   Dark Mode
   ========================================= */
html.dark {
  /* Semantic Colors - Dark Mode */
  --color-background: var(--color-gray-900);
  --color-surface: var(--color-gray-800);
  --color-text-primary: var(--color-gray-100);
  --color-text-secondary: var(--color-gray-400);

  /* Primary Adjustment (increase lightness for dark backgrounds) */
  --color-primary-500: oklch(65% 0.20 var(--primary-hue));
  --color-accent: var(--color-primary-500);
  --color-link: oklch(72% 0.18 var(--primary-hue));
  --color-link-hover: oklch(78% 0.16 var(--primary-hue));

  /* Semantic State Colors - Dark Mode */
  --color-success: oklch(75% 0.18 145);
  --color-success-bg: oklch(75% 0.18 145 / 0.15);
  --color-warning: oklch(85% 0.16 75);
  --color-warning-bg: oklch(85% 0.16 75 / 0.15);
  --color-error: oklch(70% 0.22 25);
  --color-error-bg: oklch(70% 0.22 25 / 0.15);
  --color-info: oklch(75% 0.18 260);
  --color-info-bg: oklch(75% 0.18 260 / 0.15);

  /* Component Colors - Dark Mode */
  --article-border: var(--color-gray-700);
  --card-border: var(--color-gray-700);

  /* Shadows - Darker and more diffused for dark mode */
  --shadow-sm: 0 1px 2px oklch(0% 0 0 / 0.2);
  --shadow-md: 0 4px 6px oklch(0% 0 0 / 0.25), 0 2px 4px oklch(0% 0 0 / 0.2);
  --shadow-lg: 0 10px 15px oklch(0% 0 0 / 0.3), 0 4px 6px oklch(0% 0 0 / 0.2);
  --shadow-xl: 0 20px 25px oklch(0% 0 0 / 0.35), 0 8px 10px oklch(0% 0 0 / 0.25);
  --shadow-2xl: 0 25px 50px oklch(0% 0 0 / 0.5);
  --shadow-inner: inset 0 2px 4px oklch(0% 0 0 / 0.2);

  /* Focus ring adjustment for dark mode */
  --focus-ring-color: oklch(72% 0.18 var(--primary-hue));
}

/* =========================================
   OS Dark Mode Preference (auto)
   Applies when html doesn't have .light class
   ========================================= */
@media (prefers-color-scheme: dark) {
  :root:not(.light) {
    --color-background: var(--color-gray-900);
    --color-surface: var(--color-gray-800);
    --color-text-primary: var(--color-gray-100);
    --color-text-secondary: var(--color-gray-400);
    --color-primary-500: oklch(65% 0.20 var(--primary-hue));
    --color-accent: var(--color-primary-500);
    --color-link: oklch(72% 0.18 var(--primary-hue));
    --color-link-hover: oklch(78% 0.16 var(--primary-hue));

    /* Semantic State Colors - Dark Mode */
    --color-success: oklch(75% 0.18 145);
    --color-success-bg: oklch(75% 0.18 145 / 0.15);
    --color-warning: oklch(85% 0.16 75);
    --color-warning-bg: oklch(85% 0.16 75 / 0.15);
    --color-error: oklch(70% 0.22 25);
    --color-error-bg: oklch(70% 0.22 25 / 0.15);
    --color-info: oklch(75% 0.18 260);
    --color-info-bg: oklch(75% 0.18 260 / 0.15);

    /* Component Colors - Dark Mode */
    --article-border: var(--color-gray-700);
    --card-border: var(--color-gray-700);

    --shadow-sm: 0 1px 2px oklch(0% 0 0 / 0.2);
    --shadow-md: 0 4px 6px oklch(0% 0 0 / 0.25), 0 2px 4px oklch(0% 0 0 / 0.2);
    --shadow-lg: 0 10px 15px oklch(0% 0 0 / 0.3), 0 4px 6px oklch(0% 0 0 / 0.2);
    --shadow-xl: 0 20px 25px oklch(0% 0 0 / 0.35), 0 8px 10px oklch(0% 0 0 / 0.25);

    --focus-ring-color: oklch(72% 0.18 var(--primary-hue));
  }
}

/* =========================================
   Reduced Motion
   ========================================= */
@media (prefers-reduced-motion: reduce) {
  :root {
    --duration-instant: 0ms;
    --duration-fast: 0ms;
    --duration-normal: 0ms;
    --duration-slow: 0ms;
    --duration-slower: 0ms;
  }

  /* View Transitions の無効化 */
  ::view-transition-group(*),
  ::view-transition-old(*),
  ::view-transition-new(*) {
    animation: none !important;
  }
}

/* =========================================
   Theme Transition Disable
   テーマ切り替え時のちらつき防止
   ========================================= */
html.theme-transitioning,
html.theme-transitioning *,
html.theme-transitioning *::before,
html.theme-transitioning *::after {
  transition: none !important;
}

/* =========================================
   View Transitions Styles
   ========================================= */
@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes fade-out {
  from { opacity: 1; }
  to { opacity: 0; }
}

@keyframes slide-from-right {
  from { transform: translateX(30px); }
  to { transform: translateX(0); }
}

@keyframes slide-to-left {
  from { transform: translateX(0); }
  to { transform: translateX(-30px); }
}

/* View Transition: ページ全体のフェード */
::view-transition-old(root) {
  animation: var(--duration-normal) var(--easing-out) both fade-out;
}

::view-transition-new(root) {
  animation: var(--duration-normal) var(--easing-out) both fade-in;
}

/* View Transition: メインコンテンツのフェード */
::view-transition-old(main-content) {
  animation: var(--duration-normal) var(--easing-out) both fade-out;
}

::view-transition-new(main-content) {
  animation: var(--duration-normal) var(--easing-out) both fade-in;
}
